name: Enhancement Triage Reminder

on:
  schedule:
    - cron: '0 9 * * 1'  # Every Monday at 9 AM UTC
  workflow_dispatch:  # Allow manual trigger

permissions:
  issues: write

jobs:
  check-untriaged:
    runs-on: ubuntu-latest
    steps:
      - name: Check for untriaged enhancements
        uses: actions/github-script@v7
        with:
          script: |
            const { data: issues } = await github.rest.issues.listForRepo({
              owner: context.repo.owner,
              repo: context.repo.repo,
              labels: 'enhancement',
              state: 'open',
              per_page: 100
            });
            
            const fourteenDaysAgo = new Date(Date.now() - 14 * 24 * 60 * 60 * 1000);
            
            const untriaged = issues.filter(issue => {
              const created = new Date(issue.created_at);
              return created < fourteenDaysAgo && issue.comments === 0;
            });
            
            if (untriaged.length > 0) {
              const list = untriaged.map(i => `- #${i.number}: ${i.title}`).join('\n');
              
              await github.rest.issues.create({
                owner: context.repo.owner,
                repo: context.repo.repo,
                title: 'ğŸ”” Triage Reminder: Untriaged Enhancement Requests',
                body: `The following enhancement requests need responses (>14 days old):\n\n${list}\n\n/cc @MikeSpreitzer @ezrasilvera @pdettori @clubanderson @dumb0002 @waltforme`,
                labels: ['triage']
              });
            }