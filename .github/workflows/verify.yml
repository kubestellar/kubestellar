name: "PR Title Verifier"

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]

jobs:
  verify:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 

      - name: Validate PR Title Format
        env:
          TITLE: ${{ github.event.pull_request.title }}
        run: |
          set -euo pipefail
          
          # Check if the PR title is empty
          if [ -z "${TITLE}" ]; then
            echo "âŒ Error: PR title cannot be empty."
            exit 1
          fi
          
          # Define allowed emoji prefixes
          if ! printf '%s' "$TITLE" | grep -qE '^(âš |âœ¨|ğŸ›|ğŸ“–|ğŸš€|ğŸŒ±)'; then
            echo "âŒ Error: Invalid PR title format."
            echo "Your PR title must start with one of the following indicators:"
            echo "- âš   Breaking change"
            echo "- âœ¨  Non-breaking feature"
            echo "- ğŸ›  Patch fix"
            echo "- ğŸ“–  Documentation"
            echo "- ğŸš€  Release"
            echo "- ğŸŒ±  Infra/Tests/Other"
            exit 1
          fi

          printf "âœ… PR title is valid: %q\n" "$TITLE"
