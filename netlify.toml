# Netlify configuration file
# https://docs.netlify.com/configure-builds/file-based-configuration/


[build]
  command = "npm run build"
  publish = ".next"

[build.environment]
  NODE_VERSION = "20.11.1"

[[plugins]]
  package = "@netlify/plugin-nextjs"

# Enable branch deploys for documentation versioning
# Version branches follow the pattern: docs/{version}
# Netlify will create deploy previews at: https://docs-X-Y-Z--kubestellar-docs.netlify.app
[context.branch-deploy]
  command = "npm run build"

# Deploy contexts for version branches
[context."docs/0.28.0"]
  command = "npm run build"

[context."docs/0.27.2"]
  command = "npm run build"

[context."docs/0.27.1"]
  command = "npm run build"

[context."docs/0.27.0"]
  command = "npm run build"

[context."docs/0.26.0"]
  command = "npm run build"

[context."docs/0.25.1"]
  command = "npm run build"

[context."docs/0.25.0"]
  command = "npm run build"

[context."docs/0.24.0"]
  command = "npm run build"

[context."docs/0.23.1"]
  command = "npm run build"

[context."docs/0.23.0"]
  command = "npm run build"

[context."docs/0.22.0"]
  command = "npm run build"

[context."docs/0.21.2"]
  command = "npm run build"

[context."docs/0.21.1"]
  command = "npm run build"

[context."docs/0.21.0"]
  command = "npm run build"

# Kubeflex version branches
[context."docs/kubeflex/0.8.0"]
  command = "npm run build"

[context."docs/kubeflex/0.7.0"]
  command = "npm run build"

# Forms configuration
[forms]
  # Enable spam filtering
  spam_protection = true

# Redirects for short URLs

# Redirect docs.kubestellar.io to kubestellar.io/docs
# [[redirects]]
#   from = "https://docs.kubestellar.io/*"
#   to = "https://kubestellar.io/docs/:splat"
#   status = 301
#   force = true

[[redirects]]
  from = "https://docs.kubestellar.io"
  to = "https://kubestellar.io/docs"
  status = 301
  force = true

# Redirect a2a.kubestellar.io to kubestellar.io/docs/a2a
# Handle old URL structure with /en/ prefix
[[redirects]]
  from = "https://a2a.kubestellar.io/en/*"
  to = "https://kubestellar.io/docs/a2a/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://a2a.kubestellar.io/en"
  to = "https://kubestellar.io/docs/a2a"
  status = 301
  force = true

[[redirects]]
  from = "https://a2a.kubestellar.io/*"
  to = "https://kubestellar.io/docs/a2a/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://a2a.kubestellar.io"
  to = "https://kubestellar.io/docs/a2a"
  status = 301
  force = true

# Redirect kubeflex.kubestellar.io to kubestellar.io/docs/kubeflex
# Handle old URL structure with /en/ prefix
[[redirects]]
  from = "https://kubeflex.kubestellar.io/en/*"
  to = "https://kubestellar.io/docs/kubeflex/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://kubeflex.kubestellar.io/en"
  to = "https://kubestellar.io/docs/kubeflex"
  status = 301
  force = true

[[redirects]]
  from = "https://kubeflex.kubestellar.io/*"
  to = "https://kubestellar.io/docs/kubeflex/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://kubeflex.kubestellar.io"
  to = "https://kubestellar.io/docs/kubeflex"
  status = 301
  force = true

# Redirect multi.kubestellar.io to kubestellar.io/docs/multi-plugin
# Handle old URL structure with /en/ prefix
[[redirects]]
  from = "https://multi.kubestellar.io/en/*"
  to = "https://kubestellar.io/docs/multi-plugin/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://multi.kubestellar.io/en"
  to = "https://kubestellar.io/docs/multi-plugin"
  status = 301
  force = true

[[redirects]]
  from = "https://multi.kubestellar.io/*"
  to = "https://kubestellar.io/docs/multi-plugin/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://multi.kubestellar.io"
  to = "https://kubestellar.io/docs/multi-plugin"
  status = 301
  force = true

# Redirect kflex.kubestellar.io to kubestellar.io/docs/kubeflex (alias for kubeflex)
[[redirects]]
  from = "https://kflex.kubestellar.io/*"
  to = "https://kubestellar.io/docs/kubeflex/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://kflex.kubestellar.io"
  to = "https://kubestellar.io/docs/kubeflex/overview/introduction"
  status = 301
  force = true

# Redirect claude.kubestellar.io to kubestellar.io/docs/kubectl-claude
[[redirects]]
  from = "https://claude.kubestellar.io/*"
  to = "https://kubestellar.io/docs/kubectl-claude/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://claude.kubestellar.io"
  to = "https://kubestellar.io/docs/kubectl-claude/overview/introduction"
  status = 301
  force = true

# Redirect project root pages to first content page
[[redirects]]
  from = "/docs/a2a"
  to = "/docs/a2a/overview/introduction"
  status = 302

[[redirects]]
  from = "/docs/a2a/"
  to = "/docs/a2a/overview/introduction"
  status = 302

[[redirects]]
  from = "/docs/kubeflex"
  to = "/docs/kubeflex/overview/introduction"
  status = 302

[[redirects]]
  from = "/docs/kubeflex/"
  to = "/docs/kubeflex/overview/introduction"
  status = 302

[[redirects]]
  from = "/docs/multi-plugin"
  to = "/docs/multi-plugin/overview/introduction"
  status = 302

[[redirects]]
  from = "/docs/multi-plugin/"
  to = "/docs/multi-plugin/overview/introduction"
  status = 302

[[redirects]]
  from = "/agenda"
  to = "https://docs.google.com/document/d/1XppfxSOD7AOX1lVVVIPWjpFkrxakfBfVzcybRg17-PM/edit?usp=share_link"
  status = 301
  force = true

[[redirects]]
  from = "/blog"
  to = "https://medium.com/@kubestellar/list/predefined:e785a0675051:READING_LIST"
  status = 301
  force = true

[[redirects]]
  from = "/code"
  to = "https://github.com/kubestellar/kubestellar"
  status = 301
  force = true

[[redirects]]
  from = "/community"
  to = "https://docs.kubestellar.io/stable/Community/_index/"
  status = 301
  force = true

[[redirects]]
  from = "/drive"
  to = "https://drive.google.com/drive/u/1/folders/1p68MwkX0sYdTvtup0DcnAEsnXElobFLS"
  status = 301
  force = true

[[redirects]]
  from = "/infomercial"
  to = "https://youtu.be/rCjQAdwvZjk"
  status = 301
  force = true

[[redirects]]
  from = "/join_us"
  to = "https://groups.google.com/g/kubestellar-dev"
  status = 301
  force = true

[[redirects]]
  from = "/joinus"
  to = "https://groups.google.com/g/kubestellar-dev"
  status = 301
  force = true

[[redirects]]
  from = "/ladder"
  to = "https://kubestellar.io/en/ladder"
  status = 301
  force = true

[[redirects]]
  from = "/ladder_stats"
  to = "https://docs.google.com/spreadsheets/d/16CxUk2tNbTB-Si0qRVwIrI_f19t9HwSby9C1djMN7Sc/edit?usp=sharing"
  status = 301
  force = true

[[redirects]]
  from = "/linkedin"
  to = "https://www.linkedin.com/feed/hashtag/?keywords=kubestellar"
  status = 301
  force = true

[[redirects]]
  from = "/quickstart"
  to = "https://kubestellar.io/en/quick-installation"
  status = 301
  force = true

[[redirects]]
  from = "/slack"
  to = "https://cloud-native.slack.com/archives/C097094RZ3M"
  status = 301
  force = true

[[redirects]]
  from = "/survey"
  to = "https://forms.gle/WJ7N6ZVtp44D9NK79"
  status = 301
  force = true

[[redirects]]
  from = "/tv"
  to = "https://youtube.com/@kubestellar"
  status = 301
  force = true

[[redirects]]
  from = "/youtube"
  to = "https://youtube.com/@kubestellar"
  status = 301
  force = true
